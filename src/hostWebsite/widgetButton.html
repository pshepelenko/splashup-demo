<script>
    const App = function _App() {
 if (_App.state.count)
 return `
   <button id="su-widget-button" onclick="() => App.state.count = !App.state.count;event.stopPropagation();this.dispatchEvent(new Event('su-open-discovery-module',{bubbles:false}))">
        <svg width="48" height="45" viewBox="0 0 48 45" fill="none" xmlns="http://www.w3.org/2000/svg">
            <ellipse cx="24" cy="22.5" rx="24" ry="22.5" fill="white"/>
            <path d="M47.5 22.5C47.5 34.6204 37.0096 44.5 24 44.5C10.9904 44.5 0.5 34.6204 0.5 22.5C0.5 10.3796 10.9904 0.5 24 0.5C37.0096 0.5 47.5 10.3796 47.5 22.5Z" stroke="#7C3AED" stroke-opacity="0.5"/>
            <path d="M16.2649 35.6059C15.8249 35.6059 15.5041 35.4979 15.3025 35.2818C15.1008 35.0657 15 34.722 15 34.2506V30.8034C15 30.5481 15.0275 30.332 15.0825 30.1552C15.1558 29.9785 15.2566 29.8311 15.385 29.7133L18.1348 27.2384C17.1632 26.9241 16.3932 26.3938 15.8249 25.6474C15.275 24.8814 15 23.7912 15 22.377V19.2834C15 18.3995 15.1375 17.6138 15.4125 16.9263C15.6875 16.2389 16.0816 15.6594 16.5949 15.188L20.1697 11.9766C20.6646 11.5444 21.2787 11.2105 22.012 10.9748C22.7453 10.7195 23.5794 10.5918 24.5144 10.5918H32.2139C32.6538 10.5918 32.9746 10.6998 33.1763 10.9159C33.3779 11.132 33.4788 11.4757 33.4788 11.9471V15.4532C33.4788 15.7085 33.4421 15.9246 33.3688 16.1014C33.3138 16.2782 33.2221 16.4255 33.0938 16.5433L30.619 18.7531C31.7739 19.028 32.6997 19.5486 33.3963 20.3146C34.1112 21.061 34.4687 22.2297 34.4687 23.8207V26.9143C34.4687 27.7982 34.3312 28.5839 34.0562 29.2714C33.7813 29.9588 33.3779 30.5383 32.8463 31.0097L29.299 34.1917C28.7858 34.6434 28.1625 34.9872 27.4292 35.2229C26.6959 35.4782 25.8709 35.6059 24.9543 35.6059H16.2649ZM28.5016 32.0998C30.2615 32.0998 31.6456 31.6579 32.6538 30.774C33.6804 29.8704 34.1937 28.5839 34.1937 26.9143V23.8207C34.1937 22.1708 33.7996 20.9922 33.0113 20.2851C32.223 19.578 31.1873 19.1263 29.904 18.9298L25.8068 18.3406C25.5685 18.3209 25.3851 18.2227 25.2568 18.0459C25.1285 17.8692 25.0643 17.6531 25.0643 17.3978C25.0643 17.1424 25.1285 16.9362 25.2568 16.779C25.3851 16.6023 25.5685 16.5139 25.8068 16.5139H32.2139C32.5622 16.5139 32.8097 16.4353 32.9563 16.2782C33.1213 16.1014 33.2038 15.8264 33.2038 15.4532V11.9471C33.2038 11.5739 33.1213 11.3087 32.9563 11.1516C32.8097 10.9748 32.5622 10.8864 32.2139 10.8864H24.5144C22.7362 10.8864 21.3429 11.3382 20.3346 12.2417C19.3264 13.1256 18.8222 14.4023 18.8222 16.0719V19.1655C18.8222 20.8155 19.2072 21.994 19.9772 22.7011C20.7654 23.4082 21.8012 23.86 23.0845 24.0564L27.2092 24.6751C27.4475 24.6948 27.6217 24.7832 27.7317 24.9403C27.86 25.0974 27.9241 25.3429 27.9241 25.6769C27.9241 25.9126 27.86 26.1188 27.7317 26.2956C27.6217 26.4527 27.4475 26.5313 27.2092 26.5313H19.8122C19.4639 26.5313 19.2072 26.6197 19.0422 26.7965C18.8956 26.9536 18.8222 27.2188 18.8222 27.592V31.0391C18.8222 31.4123 18.8956 31.6873 19.0422 31.8641C19.2072 32.0212 19.4639 32.0998 19.8122 32.0998H28.5016Z" fill="url(#paint0_linear_666_31832)"/>
            <path d="M28.5153 32.1079C30.2752 32.1079 31.6593 31.666 32.6675 30.7821C33.6941 29.8785 34.2074 28.592 34.2074 26.9224V23.8288C34.2074 22.1789 33.8133 21.0003 33.025 20.2932C32.2367 19.5861 31.2009 19.1344 29.9177 18.9379L25.8205 18.3487C25.5822 18.329 25.3988 18.2308 25.2705 18.054C25.1422 17.8773 25.078 17.6612 25.078 17.4059C25.078 17.1505 25.1422 16.9443 25.2705 16.7871C25.3988 16.6104 25.5822 16.522 25.8205 16.522H32.2275C32.5759 16.522 32.8233 16.4434 32.97 16.2863C33.135 16.1095 33.2175 15.8345 33.2175 15.4613V11.9552C33.2175 11.582 33.135 11.3168 32.97 11.1597C32.8233 10.9829 32.5759 10.8945 32.2275 10.8945H24.5281C22.7498 10.8945 21.3566 11.3463 20.3483 12.2498C19.3401 13.1337 18.8359 14.4105 18.8359 16.08V19.1736C18.8359 20.8236 19.2209 22.0021 19.9909 22.7092C20.7791 23.4163 21.8149 23.8681 23.0982 24.0645L27.2229 24.6832C27.4612 24.7029 27.6354 24.7913 27.7453 24.9484C27.8737 25.1055 27.9378 25.3511 27.9378 25.685C27.9378 25.9207 27.8737 26.1269 27.7453 26.3037C27.6354 26.4608 27.4612 26.5394 27.2229 26.5394H19.8259C19.4776 26.5394 19.2209 26.6278 19.0559 26.8046C18.9093 26.9617 18.8359 27.2269 18.8359 27.6001V31.0472C18.8359 31.4204 18.9093 31.6954 19.0559 31.8722C19.2209 32.0293 19.4776 32.1079 19.8259 32.1079H28.5153Z" fill="url(#paint1_linear_666_31832)"/>
            <defs>
            <linearGradient id="paint0_linear_666_31832" x1="24.7344" y1="10.6183" x2="24.7344" y2="39.2752" gradientUnits="userSpaceOnUse">
            <stop stop-color="#2D14F4"/>
            <stop offset="0.911458" stop-color="#F784AD"/>
            <stop offset="1" stop-color="#EBEEFA" stop-opacity="0"/>
            </linearGradient>
            <linearGradient id="paint1_linear_666_31832" x1="24.748" y1="10.6264" x2="24.748" y2="39.2833" gradientUnits="userSpaceOnUse">
            <stop stop-color="white"/>
            <stop offset="0.911458" stop-color="#F784AD"/>
            <stop offset="1" stop-color="#EBEEFA" stop-opacity="0"/>
            </linearGradient>
            </defs>
        </svg>
    </button>
 ` 
 else
 return `
   <button id="su-widget-button" onclick="event.stopPropagation();this.dispatchEvent(new Event('su-open-discovery-module',{bubbles:false}))">
        <svg width="48" height="45" viewBox="0 0 48 45" fill="none" xmlns="http://www.w3.org/2000/svg">
            <ellipse cx="24" cy="22.5" rx="24" ry="22.5" fill="white"/>
            <path d="M47.5 22.5C47.5 34.6204 37.0096 44.5 24 44.5C10.9904 44.5 0.5 34.6204 0.5 22.5C0.5 10.3796 10.9904 0.5 24 0.5C37.0096 0.5 47.5 10.3796 47.5 22.5Z" stroke="#7C3AED" stroke-opacity="0.5"/>
            <path d="M31 11L17 33M17 11L31 33" stroke="#934DD0" stroke-width="2"/>
        </svg>
    </button>
 `
};

App.state = {
 count: true,
 clickAction: () => {
   setState(() => App.state.count = !App.state.count);
   //event.stopPropagation();
   //this.dispatchEvent(new Event('su-open-discovery-module',{bubbles:false}));
   console.log('widget button was pushed') 
 }
};

const setState = (callback) => {
 callback();
 updateTree(); // extracted function
}

const updateTree = () => {
 document.getElementById("app").innerHTML = App();
 document
   .getElementById("su-widget-button")
   .addEventListener("click", App.state.clickAction);
 
};

updateTree();
</script>